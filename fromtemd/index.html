<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Journly</title>
</head>
<body>

    <header>
        <h1>Journly</h1>
    </header>

    <main>
        <section class="new-entry-section">
            <h2>New Entry</h2>
            <form id="newEntryForm">
                <label for="title">Title:</label>
                <input type="text" id="title" name="title" required>

                <label for="content">Content:</label>
                <textarea id="content" name="content" rows="4" required></textarea>

                <button type="submit">Add Entry</button>
            </form>
        </section>

        <section class="entries-list-section">
            <h2>My Entries</h2>
            <div id="entriesList" class="entries-grid">
            </div>
        </section>
    </main>

    <!-- Pop-up Modal -->
    <div id="popup-overlay" class="popup-overlay">
        <div class="popup-content">
            <div class="popup-header">
                <h3 id="popup-title">Message</h3>
                <button id="close-popup" class="close-btn">&times;</button>
            </div>
            <div class="popup-body">
                <p id="popup-message"></p>
            </div>
            <div class="popup-footer">
                <button id="popup-ok" class="ok-btn">OK</button>
            </div>
        </div>
    </div>

    <style>
/* Basic Reset and Global Styles */
* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

body {
    font-family: Arial, sans-serif;
    background-color: #f4f4f9;
    color: #333;
    line-height: 1.6;
    display: flex;
    flex-direction: column;
    align-items: center;
}

header {
    background: #5c67f2;
    color: #fff;
    padding: 1rem 0;
    text-align: center;
    width: 100%;
    margin-bottom: 2rem;
}

main {
    width: 90%;
    max-width: 1200px;
}

/* Form Styling */
.new-entry-section {
    background: #fff;
    padding: 2rem;
    border-radius: 8px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    margin-bottom: 2rem;
}

h2 {
    color: #5c67f2;
    margin-bottom: 1rem;
}

#newEntryForm label {
    display: block;
    margin-top: 1rem;
    font-weight: bold;
}

#newEntryForm input,
#newEntryForm textarea {
    width: 100%;
    padding: 0.5rem;
    margin-top: 0.5rem;
    border: 1px solid #ddd;
    border-radius: 4px;
}

#newEntryForm button {
    display: block;
    width: 100%;
    padding: 0.75rem;
    margin-top: 1.5rem;
    background: #5c67f2;
    color: #fff;
    border: none;
    border-radius: 4px;
    font-size: 1rem;
    cursor: pointer;
    transition: background-color 0.3s ease;
}

#newEntryForm button:hover {
    background: #4a54e1;
}

/* Entries List Styling */
.entries-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
    gap: 1.5rem;
}

.journal-entry {
    background: #fff;
    padding: 1.5rem;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
    display: flex;
    flex-direction: column;
    justify-content: space-between;
}

.entry-title {
    font-size: 1.2rem;
    margin-bottom: 0.5rem;
    color: #333;
}

.entry-content {
    font-size: 0.9rem;
    color: #666;
    white-space: pre-wrap;
}

.delete-btn {
    align-self: flex-end;
    margin-top: 1rem;
    background: #e74c3c;
    color: #fff;
    border: none;
    border-radius: 4px;
    padding: 0.5rem 1rem;
    cursor: pointer;
    transition: background-color 0.3s ease;
}

.delete-btn:hover {
    background: #c0392b;
}

/* Pop-up Styling */
.popup-overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.6);
    z-index: 1000;
    animation: fadeIn 0.3s ease-in-out;
}

.popup-overlay.show {
    display: flex;
    justify-content: center;
    align-items: center;
}

.popup-content {
    background: white;
    border-radius: 12px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    max-width: 400px;
    width: 90%;
    max-height: 80vh;
    overflow: hidden;
    animation: popIn 0.3s ease-out;
}

.popup-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1.5rem 1.5rem 1rem;
    border-bottom: 1px solid #eee;
}

.popup-header h3 {
    margin: 0;
    color: #333;
    font-size: 1.2rem;
}

.close-btn {
    background: none;
    border: none;
    font-size: 1.5rem;
    color: #999;
    cursor: pointer;
    padding: 0;
    width: 30px;
    height: 30px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    transition: all 0.2s ease;
}

.close-btn:hover {
    background-color: #f5f5f5;
    color: #333;
}

.popup-body {
    padding: 1.5rem;
}

.popup-body p {
    margin: 0;
    line-height: 1.6;
    color: #666;
}

.popup-footer {
    padding: 1rem 1.5rem 1.5rem;
    display: flex;
    justify-content: flex-end;
    border-top: 1px solid #eee;
}

.ok-btn {
    background: #5c67f2;
    color: white;
    border: none;
    padding: 0.75rem 2rem;
    border-radius: 6px;
    cursor: pointer;
    font-size: 0.9rem;
    font-weight: 500;
    transition: background-color 0.2s ease;
}

.ok-btn:hover {
    background: #4a54e1;
}

/* Pop-up for errors */
.popup-overlay.error .popup-header {
    background-color: #fee;
    border-bottom-color: #fcc;
}

.popup-overlay.error .popup-header h3 {
    color: #e74c3c;
}

.popup-overlay.error .ok-btn {
    background: #e74c3c;
}

.popup-overlay.error .ok-btn:hover {
    background: #c0392b;
}

/* Pop-up for success */
.popup-overlay.success .popup-header {
    background-color: #efe;
    border-bottom-color: #cfc;
}

.popup-overlay.success .popup-header h3 {
    color: #27ae60;
}

.popup-overlay.success .ok-btn {
    background: #27ae60;
}

.popup-overlay.success .ok-btn:hover {
    background: #219a52;
}

/* Animations */
@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

@keyframes popIn {
    from {
        opacity: 0;
        transform: scale(0.8) translateY(-20px);
    }
    to {
        opacity: 1;
        transform: scale(1) translateY(0);
    }
}
    </style>

    <script>
document.addEventListener('DOMContentLoaded', () => {
    const newEntryForm = document.getElementById('newEntryForm');
    const entriesList = document.getElementById('entriesList');
    const popupOverlay = document.getElementById('popup-overlay');
    const popupTitle = document.getElementById('popup-title');
    const popupMessage = document.getElementById('popup-message');
    const closePopup = document.getElementById('close-popup');
    const popupOk = document.getElementById('popup-ok');

    const API_URL = 'http://localhost:8080/api/journly'; 

    // Function to show pop-up
    const showPopup = (title, message, isError = false) => {
        popupTitle.textContent = title;
        popupMessage.textContent = message;
        
        // Remove existing classes and add appropriate class
        popupOverlay.classList.remove('success', 'error');
        if (isError) {
            popupOverlay.classList.add('error');
        } else {
            popupOverlay.classList.add('success');
        }
        
        popupOverlay.classList.add('show');
    };

    // Function to hide pop-up
    const hidePopup = () => {
        popupOverlay.classList.remove('show');
    };

    // Event listeners for closing pop-up
    closePopup.addEventListener('click', hidePopup);
    popupOk.addEventListener('click', hidePopup);
    
    // Close pop-up when clicking outside
    popupOverlay.addEventListener('click', (e) => {
        if (e.target === popupOverlay) {
            hidePopup();
        }
    });

    // Close pop-up with Escape key
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && popupOverlay.classList.contains('show')) {
            hidePopup();
        }
    });

    // Function to fetch all entries and display them
    const fetchEntries = async () => {
        try {
            const response = await fetch(API_URL);
            if (!response.ok) {
                throw new Error('Failed to fetch entries. Is the server running?');
            }
            const entries = await response.json();
            entriesList.innerHTML = '';
            entries.forEach(entry => {
                const entryDiv = document.createElement('div');
                entryDiv.classList.add('journal-entry');
                entryDiv.innerHTML = `
                    <h3 class="entry-title">${entry.title}</h3>
                    <p class="entry-content">${entry.content}</p>
                    <button class="delete-btn" data-id="${entry.id}">Delete</button>
                `;
                entriesList.appendChild(entryDiv);
            });
        } catch (error) {
            console.error('Error fetching entries:', error);
            showPopup('Connection Error', error.message, true);
        }
    };

    // Function to handle form submission (creating a new entry)
    newEntryForm.addEventListener('submit', async (e) => {
        e.preventDefault();
        const title = document.getElementById('title').value;
        const content = document.getElementById('content').value;

        try {
            const response = await fetch(API_URL, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ title, content })
            });

            if (!response.ok) {
                throw new Error('Failed to create entry. Please try again.');
            }
            
            newEntryForm.reset();
            fetchEntries();
            showPopup('Success', 'Entry created successfully!', false);

        } catch (error) {
            console.error('Error creating new entry:', error);
            showPopup('Error', error.message, true);
        }
    });

    // Function to handle deleting an entry
    entriesList.addEventListener('click', async (e) => {
        if (e.target.classList.contains('delete-btn')) {
            const id = e.target.dataset.id;
            try {
                const response = await fetch(`${API_URL}/${id}`, {
                    method: 'DELETE'
                });
                
                if (!response.ok) {
                     throw new Error('Failed to delete entry. Please try again.');
                }
                
                fetchEntries();
                showPopup('Success', 'Entry deleted successfully!', false);

            } catch (error) {
                console.error('Error deleting entry:', error);
                showPopup('Error', error.message, true);
            }
        }
    });

    // Initial fetch of entries
    fetchEntries();
});
    </script>
</body>
</html>